# Numbers Core

`numbers_core` — легковесная библиотека на Python, которая выполняет
числовые расчёты (нумерологический профиль) и, при необходимости, вызывает
AI-клиент для текстового анализа. Пакет не содержит интеграций с Telegram,
PDF или фронтендом и подходит как базовый слой для любых приложений.

## Возможности

- Расчёт базового профиля (число жизненного пути, выражения, души, личности).
- Дополнительные показатели: баланс, рост, реализация, разум.
- Таблицы совместимости и «мосты» между профилями.
- Персональные дни, месяцы и годы.
- Опциональный текстовый анализ профиля через настраиваемый AI-клиент.

## Требования

- Python 3.10 или выше.
- Внешние зависимости отсутствуют: библиотека использует только стандартную
  библиотеку Python.

## Установка

```bash
pip install -e .
```

> Используйте `pip install .`, если не планируете править исходники.

## Быстрый старт

```python
from numbers_core import ProfileInput, run

result = run(ProfileInput(name="Иван", birthdate="1990-01-01"))
print(result["profile"])      # словарь с числовыми показателями
print(result["analysis"]["text"])  # текст от мок-клиента
```

- `profile` — словарь с ключами `life_path`, `birthday`, `expression`, `soul`,
  `personality`.
- `analysis` — словарь с ключом `text`. По умолчанию возвращает сообщение от
  `MockAIClient`.

## Расчёты по частям

Если нужен только числовой расчёт:

```python
from numbers_core.calc import calculate_core_profile

profile = calculate_core_profile("Иван Иванов", "01.01.1990")
```

Дополнительные функции доступны в модуле `numbers_core.calc` (баланс, месяцы,
совместимость и т.д.). Список экспортируемых функций смотрите в
`numbers_core/calc/__init__.py`.

## Подключение собственного AI-клиента

Реализуйте протокол `AIClient`:

```python
from numbers_core import ProfileInput, run
from numbers_core.intelligence.engine import AIClient

class MyAIClient:
    def generate(self, prompt: str) -> str:
        return "Результат от внешнего сервиса"

result = run(ProfileInput(name="Иван", birthdate="1990-01-01"), ai=MyAIClient())
```

Мок-клиент (`MockAIClient`) остаётся полезным для тестов или офлайн-режима.

## Расширение библиотеки

- **Новые расчёты**: добавляйте функции в `numbers_core/calc` и экспортируйте их
  в `__init__.py`.
- **Анализ**: дополняйте `numbers_core/intelligence/analysis.py` новыми форматами
  промптов или возвращаемых структур.
- **Интеграции**: используйте `numbers_core.core.orchestrator.run` как готовый
  фасад для любых приложений (CLI, веб, боты и т.п.).

## Тестирование

```bash
python -m pytest numbers_core/tests
```

Тесты покрывают базовые сценарии (расчёт профиля и оркестратор). Добавляйте
собственные проверки в `numbers_core/tests` по мере развития проекта.

## Структура репозитория

- `numbers_core/calc` — расчёты числовых показателей, календарей, совместимости
- `numbers_core/core` — оркестратор: сбор входных данных, вызов расчётов и AI
- `numbers_core/intelligence` — протокол AI-клиента и базовый анализ
- `numbers_core/tests` — элементарные тесты

## Поддержка и обратная связь

Пакет проектировался как ядро для последующих интеграций. Если у вас есть
предложения по расширению, откройте issue или pull request в соответствующем
репозитории.
